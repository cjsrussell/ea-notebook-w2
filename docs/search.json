[
  {
    "objectID": "reports/antiReligion/rebelliousness.html",
    "href": "reports/antiReligion/rebelliousness.html",
    "title": "Rebelliousness (trolling)",
    "section": "",
    "text": "Global and Country-level Means and Standard Deviations\n\n\n\n\n\n\n\n\n\n\n\nRebelliousness (trolling)\n\n\nNormativity\n\n\n\nCountry\nMean\nSD\nMean\nSD\n\n\n\n\nBrazil\n1.707707\n1.142773\n5.395384\n1.251138\n\n\nChina\n3.776154\n1.747626\n4.445744\n1.437853\n\n\nDenmark\n2.411812\n1.347683\n2.636257\n1.627784\n\n\nJapan\n2.224407\n1.188694\n3.029182\n1.204015\n\n\nUK\n2.594947\n1.547145\n3.039862\n1.745857\n\n\nUSA\n2.481169\n1.626131\n4.012933\n1.523088\n\n\nGlobal\n2.542711\n1.582633\n3.753059\n1.758938\n\n\n\n\n\n\n\n\n\n\n\nRebelliousness (trolling)NormativityBelief in GodAnti-religiosityAge\n\n\n\n\nCode\ndat %&gt;%\n  ggplot(aes(x = rebelliousnessTrolling, fill = country)) +\n  geom_density(alpha = 0.5) + \n  facet_wrap(~country) +        \n  labs(title = \"Density of Rebelliousness (trolling) by Country\",\n       x = \"Rebelliousness (trolling)\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(normativity), fill = country)) +\n  geom_density(alpha = 0.5) + \n  facet_wrap(~country) +        \n  labs(title = \"Density of Normativity by Country\",\n       x = \"Normativity\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(beliefInGod_ord), fill = country)) +\n  geom_histogram(alpha = 0.5, position = \"identity\", bins = 7) + \n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Belief in God by Country\",\n       x = \"Belief in God\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(antiReligiosity), fill = country)) +\n  geom_histogram(alpha = 0.5, position = \"identity\", bins = 7) + \n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Anti-religiosity by Country\",\n       x = \"Anti-religiosity\",\n       y = \"Density\") + \n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = age, fill = country)) +\n  geom_density(alpha = 0.5) + # Use geom_histogram instead of geom_density\n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Age by Country\",\n       x = \"Age\",\n       y = \"Count\") + # Change y-axis label to \"Count\" for histograms\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCountry Level EffectsGlobal Fixed Effects\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalPlot_rebellTrollBiG &lt;- \n  posterior_params |&gt;\n  filter(country == \"Combined\") |&gt;\nggplot(aes(x = value, y = var)) +\n  stat_halfeye(\n    aes(fill = after_stat(level)),\n    .width = c(.89, .95, 1),\n    show_point = FALSE,\n    show_interval = FALSE\n  ) +\n  # 95% CI line only\n  stat_pointinterval(\n    .width = .95,\n    point_interval = \"median_qi\",\n    interval_size = .8,  # Adjust thickness of the 95% CI line\n    point_size = 1.5  # Adjust size of median point\n  ) +\n  scale_x_continuous(limits = c(-1, 2)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  scale_fill_brewer(palette = \"Blues\", direction = -1, na.translate = FALSE, labels = c(\"89%\", \"0.95%\", \"100%\")) +\n  theme_minimal() +\n  labs(\n    title = \"Parameter Values for Belief In God\",\n    subtitle = \"with median & intervals\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) +\nfacet_wrap(~country, ncol = 2, labeller = as_labeller(c(\n    \"Combined\" = \"Global Fixed Effects\",\n    \"USA\" = \"USA\",\n    \"UK\" = \"UK\",\n    \"Brazil\" = \"Brazil\",\n    \"Denmark\" = \"Denmark\",\n    \"Japan\" =  \"Japan\",\n    \"China\" =  \"China\"\n  ))) +\n  scale_y_discrete(labels = c(\n    \"age\" = \"Age\",\n    \"genderMale\" = \"Gender (Male)\",\n    \"rebelliousnessTrolling\" = \"Rebelliousness (trolling)\",\n    \"normativity\" = \"Normativity\",\n    \"normativity:rebelliousnessTrolling\" = \"Interaction\"\n  ))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese are the levels of anti-religiosity that the model predicts for each level of rebelliousness (trolling) in each of the countries.\n\n\nPlot code\n# for some reason these plots ask for 4 colours.... we add black but it does nothing\n\nblue3 &lt;- c(pal_material(palette = \"blue\")(10)[c(2, 5, 8)], \"black\")\norange3 &lt;- c(pal_material(palette = \"orange\")(10)[c(2, 5, 8)], \"black\")\nred3 &lt;- c(pal_material(palette = \"red\")(10)[c(2, 5, 8)], \"black\")\ngreen3 &lt;- c(pal_material(palette = \"green\")(10)[c(2, 5, 8)], \"black\")\npurple3 &lt;- c(pal_material(palette = \"purple\")(10)[c(2, 5, 8)], \"black\")\nbrown3 &lt;- c(pal_material(palette = \"brown\")(10)[c(2, 5, 8)], \"black\")\n\nplot_list &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(predsCombinedOrig$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- predsCombinedOrig[predsCombinedOrig$country == country_name, ]\n  \n  #round normativity labels\n  \n  country_data$normativityOrig &lt;- factor(round(as.numeric(as.character(country_data$normativityOrig)), 2))\n\n  # Create a ggplot for each country\n  p &lt;- ggplot(country_data, aes(x = rebelliousnessTrollingOrig, y = .epred)) +\n    # Ribbon fill with alpha\n    stat_lineribbon(aes(fill = factor(normativityOrig)), \n                    .width = 0.89, alpha = 0.3, color = NA, point_interval = \"median_qi\") +\n    # Ribbon line\n    stat_lineribbon(aes(color = factor(normativityOrig)), \n                    .width = 0.89, fill = NA, linewidth = 1, guide = \"none\")  +\n    scale_y_continuous(limits = c(0, 7)) +\n\n    \n    theme_minimal() +\n    theme(\n      legend.position = \"none\") +\n    labs(\n      title = country_name,  # Each plot gets a subheading with the country name\n      y = \"Belief In God\",\n      x = \"Rebelliousness (trolling)\",\n      fill = \"Normativity\") +\n    \n    # Add custom colors for each country\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    \n    guides(fill = guide_legend(override.aes = list(alpha = 1)))\n  \n  # Append the plot to the list\n  plot_list[[country_name]] &lt;- p\n}\n\n\n# Combine the individual plots using patchwork and add the global title\n\nfinal_plot &lt;- wrap_plots(plot_list) +\n  plot_annotation(\n    title = \"Predicted values for Belief In God by Rebelliousness (trolling)\",\n    subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n# Now create the legend-only plot\n\n\nlegend_plot &lt;- ggplot(data.frame(x = 1:3, y = 1:3, level = factor(1:3)), \n                      aes(x, y, fill = level)) +\n  geom_tile() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n        legend.margin = margin(0, 0, 0, 0),\n    legend.box.margin = margin(0, 0, 0, 0)\n  ) \n\n# Extract only the legend\nlegend_only &lt;- ggplotGrob(legend_plot)$grobs[[which(sapply(ggplotGrob(legend_plot)$grobs, function(x) x$name) == \"guide-box\")]]\n\ntable_grob_to_ggplot &lt;- function(table_grob) {\n  ggplot() +\n    annotation_custom(table_grob) +\n    theme_void()\n}\n\n# Convert your tableGrob to a ggplot object\nlegendPlot &lt;- table_grob_to_ggplot(legend_only)\n\n\npredsPlot_rebellTrollBiG &lt;- final_plot / \n  plot_spacer() / \n  legend_only / \n  plot_spacer() +\n  plot_layout(\n    heights = c(20, 1, 1, 1)\n  ) +\n  plot_annotation(title = \"Predicted values for Belief In God by Rebelliousness (trolling)\",\n                  subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nMarginal Effects Code\nglobalAME_rebellTrollBiG &lt;- modNormativityRebellTrollBiG %&gt;% \n  emtrends(~ normativity, \n           var = \"rebelliousnessTrolling\", \n           at = list(normativity = c(-1,  0, 1), \n                     gender = c(\"Female\", \"Male\"),\n                     age = mean(datStd$age)),\n           epred = TRUE) %&gt;% \n  gather_emmeans_draws()\n\n# Convert back to original scale\nglobalAME_rebellTrollBiG &lt;- globalAME_rebellTrollBiG %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\ncountryAME_rebellTrollBiG &lt;- modNormativityRebellTrollBiG %&gt;%\n  emtrends(\n    ~ country + normativity,\n    var = \"rebelliousnessTrolling\",\n    at = list(\n      normativity = c(-1,  0, 1),\n      gender = c(\"Female\", \"Male\"),\n      age = mean(datStd$age)\n    ),\n    epred = TRUE,\n    re_formula = NULL\n  ) %&gt;%\n  gather_emmeans_draws()\n\n# Convert back to original scale\ncountryAME_rebellTrollBiG &lt;- countryAME_rebellTrollBiG %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\n\nCountry Level EffectsGlobal Effects\n\n\n\n\nCode\nplot_list2 &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(countryAME_rebellTrollBiG$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- countryAME_rebellTrollBiG[countryAME_rebellTrollBiG$country == country_name, ]\n\n  p &lt;- ggplot(country_data, aes(x = .value, fill = factor(normativity))) +\n    stat_halfeye() +\n    scale_x_continuous(limits = c(-1.5, .5), breaks = seq(-1.5, .5, by = 0.25)) +\n    scale_y_continuous(limits = c(0, 1)) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n    theme_minimal() +\n    labs(\n      title = country_name,\n      y = NULL,\n      x = \"Average Marginal Effect\",\n      fill = \"Normativity\") +\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    theme(\n      legend.position = \"none\",\n      panel.grid.major.y = element_blank(),\n      panel.grid.minor.y = element_blank(),\n            axis.text.y = element_blank(),\n      axis.text.x = if (country_name == \"USA\") element_text() else element_blank(),\n      axis.title.x = if (country_name == \"USA\") element_text() else element_blank()\n    )\n  \n  # Append the plot to the list\n  plot_list2[[country_name]] &lt;- p\n}\n\n\n\nfinal_plot2 &lt;- wrap_plots(plot_list2, ncol = 1) +\n  plot_annotation(\n    title = \"Average Change in Belief in God\",\n    subtitle = \"Per 1SD increase in Rebelliousness (trolling)\")\n\ncountryAMEPlot_rebellTrollBiG &lt;- final_plot2 + legend_only\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalAMEPlot_rebellTrollBiG &lt;- globalAME_rebellTrollBiG  |&gt;\n  ggplot( aes(x=.value, fill = factor(normativity))) +\n   stat_halfeye() +\n  scale_x_continuous(limits = c(-1.5, 1.5)) +\n  scale_y_continuous(limits = c(0, 1)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  labs(\n    title = \"Predicted Change in Belief in God\",\n    subtitle = \"Per 1SD increase in Rebelliousness (Trolling)\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCountry Level EffectsGlobal Fixed Effects\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalPlot_rebellTrollAR &lt;- \n  posterior_params |&gt;\n  filter(country == \"Combined\") |&gt;\nggplot(aes(x = value, y = var)) +\n  stat_halfeye(\n    aes(fill = after_stat(level)),\n    .width = c(.89, .95, 1),\n    show_point = FALSE,\n    show_interval = FALSE\n  ) +\n  # 95% CI line only\n  stat_pointinterval(\n    .width = .95,\n    point_interval = \"median_qi\",\n    interval_size = .8,  # Adjust thickness of the 95% CI line\n    point_size = 1.5  # Adjust size of median point\n  ) +\n  scale_x_continuous(limits = c(-1, 2)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  scale_fill_brewer(palette = \"Blues\", direction = -1, na.translate = FALSE, labels = c(\"89%\", \"0.95%\", \"100%\")) +\n  theme_minimal() +\n  labs(\n    title = \"Parameter Values for Anti-Religiosity\",\n    subtitle = \"with median & intervals\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) +\nfacet_wrap(~country, ncol = 2, labeller = as_labeller(c(\n    \"Combined\" = \"Global Fixed Effects\",\n    \"USA\" = \"USA\",\n    \"UK\" = \"UK\",\n    \"Brazil\" = \"Brazil\",\n    \"Denmark\" = \"Denmark\",\n    \"Japan\" =  \"Japan\",\n    \"China\" =  \"China\"\n  ))) +\n  scale_y_discrete(labels = c(\n    \"age\" = \"Age\",\n    \"genderMale\" = \"Gender (Male)\",\n    \"rebelliousnessTrolling\" = \"Rebelliousness (trolling)\",\n    \"normativity\" = \"Normativity\",\n    \"normativity:rebelliousnessTrolling\" = \"Interaction\"\n  ))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese are the levels of anti-religiosity that the model predicts for each level of rebelliousness (trolling) in each of the countries.\n\n\nPlot code\n# for some reason these plots ask for 4 colours.... we add black but it does nothing\n\nblue3 &lt;- c(pal_material(palette = \"blue\")(10)[c(2, 5, 8)], \"black\")\norange3 &lt;- c(pal_material(palette = \"orange\")(10)[c(2, 5, 8)], \"black\")\nred3 &lt;- c(pal_material(palette = \"red\")(10)[c(2, 5, 8)], \"black\")\ngreen3 &lt;- c(pal_material(palette = \"green\")(10)[c(2, 5, 8)], \"black\")\npurple3 &lt;- c(pal_material(palette = \"purple\")(10)[c(2, 5, 8)], \"black\")\nbrown3 &lt;- c(pal_material(palette = \"brown\")(10)[c(2, 5, 8)], \"black\")\n\nplot_list &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(predsCombinedOrig$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- predsCombinedOrig[predsCombinedOrig$country == country_name, ]\n  \n  #round normativity labels\n  \n  country_data$normativityOrig &lt;- factor(round(as.numeric(as.character(country_data$normativityOrig)), 2))\n\n  # Create a ggplot for each country\n  p &lt;- ggplot(country_data, aes(x = rebelliousnessTrollingOrig, y = .epred)) +\n    # Ribbon fill with alpha\n    stat_lineribbon(aes(fill = factor(normativityOrig)), \n                    .width = 0.89, alpha = 0.3, color = NA, point_interval = \"median_qi\") +\n    # Ribbon line\n    stat_lineribbon(aes(color = factor(normativityOrig)), \n                    .width = 0.89, fill = NA, linewidth = 1, guide = \"none\")  +\n    scale_y_continuous(limits = c(0, 7)) +\n\n    \n    theme_minimal() +\n    theme(\n      legend.position = \"none\") +\n    labs(\n      title = country_name,  # Each plot gets a subheading with the country name\n      y = \"Anti-Religiosity\",\n      x = \"Rebelliousness (trolling)\",\n      fill = \"Normativity\") +\n    \n    # Add custom colors for each country\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    \n    guides(fill = guide_legend(override.aes = list(alpha = 1)))\n  \n  # Append the plot to the list\n  plot_list[[country_name]] &lt;- p\n}\n\n\n# Combine the individual plots using patchwork and add the global title\n\nfinal_plot &lt;- wrap_plots(plot_list) +\n  plot_annotation(\n    title = \"Predicted values for Anti-Religiosity by Rebelliousness (trolling)\",\n    subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n# Now create the legend-only plot\n\n\nlegend_plot &lt;- ggplot(data.frame(x = 1:3, y = 1:3, level = factor(1:3)), \n                      aes(x, y, fill = level)) +\n  geom_tile() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n        legend.margin = margin(0, 0, 0, 0),\n    legend.box.margin = margin(0, 0, 0, 0)\n  ) \n\n# Extract only the legend\nlegend_only &lt;- ggplotGrob(legend_plot)$grobs[[which(sapply(ggplotGrob(legend_plot)$grobs, function(x) x$name) == \"guide-box\")]]\n\ntable_grob_to_ggplot &lt;- function(table_grob) {\n  ggplot() +\n    annotation_custom(table_grob) +\n    theme_void()\n}\n\n# Convert your tableGrob to a ggplot object\nlegendPlot &lt;- table_grob_to_ggplot(legend_only)\n\n\npredsPlot_rebellTrollAR &lt;- final_plot / \n  plot_spacer() / \n  legend_only / \n  plot_spacer() +\n  plot_layout(\n    heights = c(20, 1, 1, 1)\n  ) +\n  plot_annotation(title = \"Predicted values for Anti-Religiosity by Rebelliousness (trolling)\",\n                  subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nMarginal Effects Code\nglobalAME_rebellTrollAR &lt;- modNormativityRebellTrollAR %&gt;% \n  emtrends(~ normativity, \n           var = \"rebelliousnessTrolling\", \n           at = list(normativity = c(-1,  0, 1), \n                     gender = c(\"Female\", \"Male\"),\n                     age = mean(datStd$age)),\n           epred = TRUE) %&gt;% \n  gather_emmeans_draws()\n\n# Convert back to original scale\nglobalAME_rebellTrollAR &lt;- globalAME_rebellTrollAR %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\ncountryAME_rebellTrollAR &lt;- modNormativityRebellTrollAR %&gt;%\n  emtrends(\n    ~ country + normativity,\n    var = \"rebelliousnessTrolling\",\n    at = list(\n      normativity = c(-1,  0, 1),\n      gender = c(\"Female\", \"Male\"),\n      age = mean(datStd$age)\n    ),\n    epred = TRUE,\n    re_formula = NULL\n  ) %&gt;%\n  gather_emmeans_draws()\n\n# Convert back to original scale\ncountryAME_rebellTrollAR &lt;- countryAME_rebellTrollAR %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\n\nCountry Level EffectsGlobal Effects\n\n\n\n\nCode\nplot_list2 &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(countryAME_rebellTrollAR$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- countryAME_rebellTrollAR[countryAME_rebellTrollAR$country == country_name, ]\n  \n  # Round normativity labels for plotting\n  country_data$normativity &lt;- factor(round(as.numeric(as.character(country_data$normativity)), 2))\n  \n\n  p &lt;- ggplot(country_data, aes(x = .value, fill = factor(normativity))) +\n    stat_halfeye() +\n    scale_x_continuous(limits = c(-.5, 1.5), breaks = seq(-.5, 1.5, by = 0.25)) +\n    scale_y_continuous(limits = c(0, 1)) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n    theme_minimal() +\n    labs(\n      title = country_name,\n      y = NULL,\n      x = \"Average Marginal Effect\",\n      fill = \"Normativity\") +\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    theme(\n      legend.position = \"none\",\n      panel.grid.major.y = element_blank(),\n      panel.grid.minor.y = element_blank(),\n            axis.text.y = element_blank(),\n      axis.text.x = if (country_name == \"USA\") element_text() else element_blank(),\n      axis.title.x = if (country_name == \"USA\") element_text() else element_blank()\n    )\n  \n  # Append the plot to the list\n  plot_list2[[country_name]] &lt;- p\n}\n\n\n\nfinal_plot2 &lt;- wrap_plots(plot_list2, ncol = 1) +\n  plot_annotation(\n    title = \"Average Change in Anti-Religiosity\",\n    subtitle = \"Per 1SD increase in Rebelliousness (trolling)\")\n\ncountryAMEPlot_rebellTrollAR &lt;- final_plot2 + legend_only\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalAMEPlot_rebellTrollAR &lt;- globalAME_rebellTrollAR  |&gt;\n  ggplot( aes(x=.value, fill = factor(normativity))) +\n   stat_halfeye() +\n  scale_x_continuous(limits = c(-1.5, 1.5)) +\n  scale_y_continuous(limits = c(0, 1)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  labs(\n    title = \"Average Change in Anti-Religiosity\",\n    subtitle = \"Per 1SD increase in Rebelliousness (Trolling)\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGlobal EffectsCountry Effects",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Rebelliousness (trolling)"
    ]
  },
  {
    "objectID": "reports/antiReligion/rebelliousness.html#predictor-variable-summaries",
    "href": "reports/antiReligion/rebelliousness.html#predictor-variable-summaries",
    "title": "Rebelliousness (trolling)",
    "section": "",
    "text": "Global and Country-level Means and Standard Deviations\n\n\n\n\n\n\n\n\n\n\n\nRebelliousness (trolling)\n\n\nNormativity\n\n\n\nCountry\nMean\nSD\nMean\nSD\n\n\n\n\nBrazil\n1.707707\n1.142773\n5.395384\n1.251138\n\n\nChina\n3.776154\n1.747626\n4.445744\n1.437853\n\n\nDenmark\n2.411812\n1.347683\n2.636257\n1.627784\n\n\nJapan\n2.224407\n1.188694\n3.029182\n1.204015\n\n\nUK\n2.594947\n1.547145\n3.039862\n1.745857\n\n\nUSA\n2.481169\n1.626131\n4.012933\n1.523088\n\n\nGlobal\n2.542711\n1.582633\n3.753059\n1.758938",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Rebelliousness (trolling)"
    ]
  },
  {
    "objectID": "reports/antiReligion/rebelliousness.html#density-plots",
    "href": "reports/antiReligion/rebelliousness.html#density-plots",
    "title": "Rebelliousness (trolling)",
    "section": "",
    "text": "Rebelliousness (trolling)NormativityBelief in GodAnti-religiosityAge\n\n\n\n\nCode\ndat %&gt;%\n  ggplot(aes(x = rebelliousnessTrolling, fill = country)) +\n  geom_density(alpha = 0.5) + \n  facet_wrap(~country) +        \n  labs(title = \"Density of Rebelliousness (trolling) by Country\",\n       x = \"Rebelliousness (trolling)\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(normativity), fill = country)) +\n  geom_density(alpha = 0.5) + \n  facet_wrap(~country) +        \n  labs(title = \"Density of Normativity by Country\",\n       x = \"Normativity\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(beliefInGod_ord), fill = country)) +\n  geom_histogram(alpha = 0.5, position = \"identity\", bins = 7) + \n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Belief in God by Country\",\n       x = \"Belief in God\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(antiReligiosity), fill = country)) +\n  geom_histogram(alpha = 0.5, position = \"identity\", bins = 7) + \n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Anti-religiosity by Country\",\n       x = \"Anti-religiosity\",\n       y = \"Density\") + \n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = age, fill = country)) +\n  geom_density(alpha = 0.5) + # Use geom_histogram instead of geom_density\n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Age by Country\",\n       x = \"Age\",\n       y = \"Count\") + # Change y-axis label to \"Count\" for histograms\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Rebelliousness (trolling)"
    ]
  },
  {
    "objectID": "reports/antiReligion/rebelliousness.html#belief-in-god-models",
    "href": "reports/antiReligion/rebelliousness.html#belief-in-god-models",
    "title": "Rebelliousness (trolling)",
    "section": "",
    "text": "Country Level EffectsGlobal Fixed Effects\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalPlot_rebellTrollBiG &lt;- \n  posterior_params |&gt;\n  filter(country == \"Combined\") |&gt;\nggplot(aes(x = value, y = var)) +\n  stat_halfeye(\n    aes(fill = after_stat(level)),\n    .width = c(.89, .95, 1),\n    show_point = FALSE,\n    show_interval = FALSE\n  ) +\n  # 95% CI line only\n  stat_pointinterval(\n    .width = .95,\n    point_interval = \"median_qi\",\n    interval_size = .8,  # Adjust thickness of the 95% CI line\n    point_size = 1.5  # Adjust size of median point\n  ) +\n  scale_x_continuous(limits = c(-1, 2)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  scale_fill_brewer(palette = \"Blues\", direction = -1, na.translate = FALSE, labels = c(\"89%\", \"0.95%\", \"100%\")) +\n  theme_minimal() +\n  labs(\n    title = \"Parameter Values for Belief In God\",\n    subtitle = \"with median & intervals\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) +\nfacet_wrap(~country, ncol = 2, labeller = as_labeller(c(\n    \"Combined\" = \"Global Fixed Effects\",\n    \"USA\" = \"USA\",\n    \"UK\" = \"UK\",\n    \"Brazil\" = \"Brazil\",\n    \"Denmark\" = \"Denmark\",\n    \"Japan\" =  \"Japan\",\n    \"China\" =  \"China\"\n  ))) +\n  scale_y_discrete(labels = c(\n    \"age\" = \"Age\",\n    \"genderMale\" = \"Gender (Male)\",\n    \"rebelliousnessTrolling\" = \"Rebelliousness (trolling)\",\n    \"normativity\" = \"Normativity\",\n    \"normativity:rebelliousnessTrolling\" = \"Interaction\"\n  ))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese are the levels of anti-religiosity that the model predicts for each level of rebelliousness (trolling) in each of the countries.\n\n\nPlot code\n# for some reason these plots ask for 4 colours.... we add black but it does nothing\n\nblue3 &lt;- c(pal_material(palette = \"blue\")(10)[c(2, 5, 8)], \"black\")\norange3 &lt;- c(pal_material(palette = \"orange\")(10)[c(2, 5, 8)], \"black\")\nred3 &lt;- c(pal_material(palette = \"red\")(10)[c(2, 5, 8)], \"black\")\ngreen3 &lt;- c(pal_material(palette = \"green\")(10)[c(2, 5, 8)], \"black\")\npurple3 &lt;- c(pal_material(palette = \"purple\")(10)[c(2, 5, 8)], \"black\")\nbrown3 &lt;- c(pal_material(palette = \"brown\")(10)[c(2, 5, 8)], \"black\")\n\nplot_list &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(predsCombinedOrig$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- predsCombinedOrig[predsCombinedOrig$country == country_name, ]\n  \n  #round normativity labels\n  \n  country_data$normativityOrig &lt;- factor(round(as.numeric(as.character(country_data$normativityOrig)), 2))\n\n  # Create a ggplot for each country\n  p &lt;- ggplot(country_data, aes(x = rebelliousnessTrollingOrig, y = .epred)) +\n    # Ribbon fill with alpha\n    stat_lineribbon(aes(fill = factor(normativityOrig)), \n                    .width = 0.89, alpha = 0.3, color = NA, point_interval = \"median_qi\") +\n    # Ribbon line\n    stat_lineribbon(aes(color = factor(normativityOrig)), \n                    .width = 0.89, fill = NA, linewidth = 1, guide = \"none\")  +\n    scale_y_continuous(limits = c(0, 7)) +\n\n    \n    theme_minimal() +\n    theme(\n      legend.position = \"none\") +\n    labs(\n      title = country_name,  # Each plot gets a subheading with the country name\n      y = \"Belief In God\",\n      x = \"Rebelliousness (trolling)\",\n      fill = \"Normativity\") +\n    \n    # Add custom colors for each country\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    \n    guides(fill = guide_legend(override.aes = list(alpha = 1)))\n  \n  # Append the plot to the list\n  plot_list[[country_name]] &lt;- p\n}\n\n\n# Combine the individual plots using patchwork and add the global title\n\nfinal_plot &lt;- wrap_plots(plot_list) +\n  plot_annotation(\n    title = \"Predicted values for Belief In God by Rebelliousness (trolling)\",\n    subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n# Now create the legend-only plot\n\n\nlegend_plot &lt;- ggplot(data.frame(x = 1:3, y = 1:3, level = factor(1:3)), \n                      aes(x, y, fill = level)) +\n  geom_tile() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n        legend.margin = margin(0, 0, 0, 0),\n    legend.box.margin = margin(0, 0, 0, 0)\n  ) \n\n# Extract only the legend\nlegend_only &lt;- ggplotGrob(legend_plot)$grobs[[which(sapply(ggplotGrob(legend_plot)$grobs, function(x) x$name) == \"guide-box\")]]\n\ntable_grob_to_ggplot &lt;- function(table_grob) {\n  ggplot() +\n    annotation_custom(table_grob) +\n    theme_void()\n}\n\n# Convert your tableGrob to a ggplot object\nlegendPlot &lt;- table_grob_to_ggplot(legend_only)\n\n\npredsPlot_rebellTrollBiG &lt;- final_plot / \n  plot_spacer() / \n  legend_only / \n  plot_spacer() +\n  plot_layout(\n    heights = c(20, 1, 1, 1)\n  ) +\n  plot_annotation(title = \"Predicted values for Belief In God by Rebelliousness (trolling)\",\n                  subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nMarginal Effects Code\nglobalAME_rebellTrollBiG &lt;- modNormativityRebellTrollBiG %&gt;% \n  emtrends(~ normativity, \n           var = \"rebelliousnessTrolling\", \n           at = list(normativity = c(-1,  0, 1), \n                     gender = c(\"Female\", \"Male\"),\n                     age = mean(datStd$age)),\n           epred = TRUE) %&gt;% \n  gather_emmeans_draws()\n\n# Convert back to original scale\nglobalAME_rebellTrollBiG &lt;- globalAME_rebellTrollBiG %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\ncountryAME_rebellTrollBiG &lt;- modNormativityRebellTrollBiG %&gt;%\n  emtrends(\n    ~ country + normativity,\n    var = \"rebelliousnessTrolling\",\n    at = list(\n      normativity = c(-1,  0, 1),\n      gender = c(\"Female\", \"Male\"),\n      age = mean(datStd$age)\n    ),\n    epred = TRUE,\n    re_formula = NULL\n  ) %&gt;%\n  gather_emmeans_draws()\n\n# Convert back to original scale\ncountryAME_rebellTrollBiG &lt;- countryAME_rebellTrollBiG %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\n\nCountry Level EffectsGlobal Effects\n\n\n\n\nCode\nplot_list2 &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(countryAME_rebellTrollBiG$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- countryAME_rebellTrollBiG[countryAME_rebellTrollBiG$country == country_name, ]\n\n  p &lt;- ggplot(country_data, aes(x = .value, fill = factor(normativity))) +\n    stat_halfeye() +\n    scale_x_continuous(limits = c(-1.5, .5), breaks = seq(-1.5, .5, by = 0.25)) +\n    scale_y_continuous(limits = c(0, 1)) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n    theme_minimal() +\n    labs(\n      title = country_name,\n      y = NULL,\n      x = \"Average Marginal Effect\",\n      fill = \"Normativity\") +\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    theme(\n      legend.position = \"none\",\n      panel.grid.major.y = element_blank(),\n      panel.grid.minor.y = element_blank(),\n            axis.text.y = element_blank(),\n      axis.text.x = if (country_name == \"USA\") element_text() else element_blank(),\n      axis.title.x = if (country_name == \"USA\") element_text() else element_blank()\n    )\n  \n  # Append the plot to the list\n  plot_list2[[country_name]] &lt;- p\n}\n\n\n\nfinal_plot2 &lt;- wrap_plots(plot_list2, ncol = 1) +\n  plot_annotation(\n    title = \"Average Change in Belief in God\",\n    subtitle = \"Per 1SD increase in Rebelliousness (trolling)\")\n\ncountryAMEPlot_rebellTrollBiG &lt;- final_plot2 + legend_only\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalAMEPlot_rebellTrollBiG &lt;- globalAME_rebellTrollBiG  |&gt;\n  ggplot( aes(x=.value, fill = factor(normativity))) +\n   stat_halfeye() +\n  scale_x_continuous(limits = c(-1.5, 1.5)) +\n  scale_y_continuous(limits = c(0, 1)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  labs(\n    title = \"Predicted Change in Belief in God\",\n    subtitle = \"Per 1SD increase in Rebelliousness (Trolling)\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  )",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Rebelliousness (trolling)"
    ]
  },
  {
    "objectID": "reports/antiReligion/rebelliousness.html#anti-religosity-models",
    "href": "reports/antiReligion/rebelliousness.html#anti-religosity-models",
    "title": "Rebelliousness (trolling)",
    "section": "",
    "text": "Country Level EffectsGlobal Fixed Effects\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalPlot_rebellTrollAR &lt;- \n  posterior_params |&gt;\n  filter(country == \"Combined\") |&gt;\nggplot(aes(x = value, y = var)) +\n  stat_halfeye(\n    aes(fill = after_stat(level)),\n    .width = c(.89, .95, 1),\n    show_point = FALSE,\n    show_interval = FALSE\n  ) +\n  # 95% CI line only\n  stat_pointinterval(\n    .width = .95,\n    point_interval = \"median_qi\",\n    interval_size = .8,  # Adjust thickness of the 95% CI line\n    point_size = 1.5  # Adjust size of median point\n  ) +\n  scale_x_continuous(limits = c(-1, 2)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  scale_fill_brewer(palette = \"Blues\", direction = -1, na.translate = FALSE, labels = c(\"89%\", \"0.95%\", \"100%\")) +\n  theme_minimal() +\n  labs(\n    title = \"Parameter Values for Anti-Religiosity\",\n    subtitle = \"with median & intervals\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) +\nfacet_wrap(~country, ncol = 2, labeller = as_labeller(c(\n    \"Combined\" = \"Global Fixed Effects\",\n    \"USA\" = \"USA\",\n    \"UK\" = \"UK\",\n    \"Brazil\" = \"Brazil\",\n    \"Denmark\" = \"Denmark\",\n    \"Japan\" =  \"Japan\",\n    \"China\" =  \"China\"\n  ))) +\n  scale_y_discrete(labels = c(\n    \"age\" = \"Age\",\n    \"genderMale\" = \"Gender (Male)\",\n    \"rebelliousnessTrolling\" = \"Rebelliousness (trolling)\",\n    \"normativity\" = \"Normativity\",\n    \"normativity:rebelliousnessTrolling\" = \"Interaction\"\n  ))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese are the levels of anti-religiosity that the model predicts for each level of rebelliousness (trolling) in each of the countries.\n\n\nPlot code\n# for some reason these plots ask for 4 colours.... we add black but it does nothing\n\nblue3 &lt;- c(pal_material(palette = \"blue\")(10)[c(2, 5, 8)], \"black\")\norange3 &lt;- c(pal_material(palette = \"orange\")(10)[c(2, 5, 8)], \"black\")\nred3 &lt;- c(pal_material(palette = \"red\")(10)[c(2, 5, 8)], \"black\")\ngreen3 &lt;- c(pal_material(palette = \"green\")(10)[c(2, 5, 8)], \"black\")\npurple3 &lt;- c(pal_material(palette = \"purple\")(10)[c(2, 5, 8)], \"black\")\nbrown3 &lt;- c(pal_material(palette = \"brown\")(10)[c(2, 5, 8)], \"black\")\n\nplot_list &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(predsCombinedOrig$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- predsCombinedOrig[predsCombinedOrig$country == country_name, ]\n  \n  #round normativity labels\n  \n  country_data$normativityOrig &lt;- factor(round(as.numeric(as.character(country_data$normativityOrig)), 2))\n\n  # Create a ggplot for each country\n  p &lt;- ggplot(country_data, aes(x = rebelliousnessTrollingOrig, y = .epred)) +\n    # Ribbon fill with alpha\n    stat_lineribbon(aes(fill = factor(normativityOrig)), \n                    .width = 0.89, alpha = 0.3, color = NA, point_interval = \"median_qi\") +\n    # Ribbon line\n    stat_lineribbon(aes(color = factor(normativityOrig)), \n                    .width = 0.89, fill = NA, linewidth = 1, guide = \"none\")  +\n    scale_y_continuous(limits = c(0, 7)) +\n\n    \n    theme_minimal() +\n    theme(\n      legend.position = \"none\") +\n    labs(\n      title = country_name,  # Each plot gets a subheading with the country name\n      y = \"Anti-Religiosity\",\n      x = \"Rebelliousness (trolling)\",\n      fill = \"Normativity\") +\n    \n    # Add custom colors for each country\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    \n    guides(fill = guide_legend(override.aes = list(alpha = 1)))\n  \n  # Append the plot to the list\n  plot_list[[country_name]] &lt;- p\n}\n\n\n# Combine the individual plots using patchwork and add the global title\n\nfinal_plot &lt;- wrap_plots(plot_list) +\n  plot_annotation(\n    title = \"Predicted values for Anti-Religiosity by Rebelliousness (trolling)\",\n    subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n# Now create the legend-only plot\n\n\nlegend_plot &lt;- ggplot(data.frame(x = 1:3, y = 1:3, level = factor(1:3)), \n                      aes(x, y, fill = level)) +\n  geom_tile() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n        legend.margin = margin(0, 0, 0, 0),\n    legend.box.margin = margin(0, 0, 0, 0)\n  ) \n\n# Extract only the legend\nlegend_only &lt;- ggplotGrob(legend_plot)$grobs[[which(sapply(ggplotGrob(legend_plot)$grobs, function(x) x$name) == \"guide-box\")]]\n\ntable_grob_to_ggplot &lt;- function(table_grob) {\n  ggplot() +\n    annotation_custom(table_grob) +\n    theme_void()\n}\n\n# Convert your tableGrob to a ggplot object\nlegendPlot &lt;- table_grob_to_ggplot(legend_only)\n\n\npredsPlot_rebellTrollAR &lt;- final_plot / \n  plot_spacer() / \n  legend_only / \n  plot_spacer() +\n  plot_layout(\n    heights = c(20, 1, 1, 1)\n  ) +\n  plot_annotation(title = \"Predicted values for Anti-Religiosity by Rebelliousness (trolling)\",\n                  subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nMarginal Effects Code\nglobalAME_rebellTrollAR &lt;- modNormativityRebellTrollAR %&gt;% \n  emtrends(~ normativity, \n           var = \"rebelliousnessTrolling\", \n           at = list(normativity = c(-1,  0, 1), \n                     gender = c(\"Female\", \"Male\"),\n                     age = mean(datStd$age)),\n           epred = TRUE) %&gt;% \n  gather_emmeans_draws()\n\n# Convert back to original scale\nglobalAME_rebellTrollAR &lt;- globalAME_rebellTrollAR %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\ncountryAME_rebellTrollAR &lt;- modNormativityRebellTrollAR %&gt;%\n  emtrends(\n    ~ country + normativity,\n    var = \"rebelliousnessTrolling\",\n    at = list(\n      normativity = c(-1,  0, 1),\n      gender = c(\"Female\", \"Male\"),\n      age = mean(datStd$age)\n    ),\n    epred = TRUE,\n    re_formula = NULL\n  ) %&gt;%\n  gather_emmeans_draws()\n\n# Convert back to original scale\ncountryAME_rebellTrollAR &lt;- countryAME_rebellTrollAR %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\n\nCountry Level EffectsGlobal Effects\n\n\n\n\nCode\nplot_list2 &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(countryAME_rebellTrollAR$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- countryAME_rebellTrollAR[countryAME_rebellTrollAR$country == country_name, ]\n  \n  # Round normativity labels for plotting\n  country_data$normativity &lt;- factor(round(as.numeric(as.character(country_data$normativity)), 2))\n  \n\n  p &lt;- ggplot(country_data, aes(x = .value, fill = factor(normativity))) +\n    stat_halfeye() +\n    scale_x_continuous(limits = c(-.5, 1.5), breaks = seq(-.5, 1.5, by = 0.25)) +\n    scale_y_continuous(limits = c(0, 1)) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n    theme_minimal() +\n    labs(\n      title = country_name,\n      y = NULL,\n      x = \"Average Marginal Effect\",\n      fill = \"Normativity\") +\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    theme(\n      legend.position = \"none\",\n      panel.grid.major.y = element_blank(),\n      panel.grid.minor.y = element_blank(),\n            axis.text.y = element_blank(),\n      axis.text.x = if (country_name == \"USA\") element_text() else element_blank(),\n      axis.title.x = if (country_name == \"USA\") element_text() else element_blank()\n    )\n  \n  # Append the plot to the list\n  plot_list2[[country_name]] &lt;- p\n}\n\n\n\nfinal_plot2 &lt;- wrap_plots(plot_list2, ncol = 1) +\n  plot_annotation(\n    title = \"Average Change in Anti-Religiosity\",\n    subtitle = \"Per 1SD increase in Rebelliousness (trolling)\")\n\ncountryAMEPlot_rebellTrollAR &lt;- final_plot2 + legend_only\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalAMEPlot_rebellTrollAR &lt;- globalAME_rebellTrollAR  |&gt;\n  ggplot( aes(x=.value, fill = factor(normativity))) +\n   stat_halfeye() +\n  scale_x_continuous(limits = c(-1.5, 1.5)) +\n  scale_y_continuous(limits = c(0, 1)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  labs(\n    title = \"Average Change in Anti-Religiosity\",\n    subtitle = \"Per 1SD increase in Rebelliousness (Trolling)\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  )",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Rebelliousness (trolling)"
    ]
  },
  {
    "objectID": "reports/antiReligion/rebelliousness.html#belief-in-god-anti-religiosity-comparison",
    "href": "reports/antiReligion/rebelliousness.html#belief-in-god-anti-religiosity-comparison",
    "title": "Rebelliousness (trolling)",
    "section": "",
    "text": "Global EffectsCountry Effects",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Rebelliousness (trolling)"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ea-notebook-w2",
    "section": "",
    "text": "This notebook contains descriptive statistics for the second survey round of the Explaining Atheism project, and some statistical reports. It functions as an internal overview for the data from each survey, and from each country. I will also include information for papers.\nThe site is split into 3 primary sections:"
  },
  {
    "objectID": "index.html#surveys",
    "href": "index.html#surveys",
    "title": "ea-notebook-w2",
    "section": "Surveys",
    "text": "Surveys\nThis section includes descriptive information for variables in our surveys. The Variable Overviews section includes descriptive information and plots about the variables used in this round, and the Variable Relationship section includes some summary plots and information about relationships between our variables. Neither subsection includes inferential statistical analyses and are intended for data exploration."
  },
  {
    "objectID": "index.html#countries",
    "href": "index.html#countries",
    "title": "ea-notebook-w2",
    "section": "Countries",
    "text": "Countries\nThis section includes overviews of each country. Specifically, we combine the data from surveys 1 through 5 to get an overview of belief in each country."
  },
  {
    "objectID": "index.html#papers",
    "href": "index.html#papers",
    "title": "ea-notebook-w2",
    "section": "Papers",
    "text": "Papers\nHere are specific models and analysis information for papers submitted based on this manuscript."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "countryInfo.html#gender",
    "href": "countryInfo.html#gender",
    "title": "Countries",
    "section": "Gender",
    "text": "Gender"
  },
  {
    "objectID": "countryInfo.html#other-demographics",
    "href": "countryInfo.html#other-demographics",
    "title": "Countries",
    "section": "Other Demographics",
    "text": "Other Demographics"
  },
  {
    "objectID": "reports/antiReligion/nonTheisticSocialisation.html",
    "href": "reports/antiReligion/nonTheisticSocialisation.html",
    "title": "Non-Theistic Socialisation",
    "section": "",
    "text": "Global and Country-level Means and Standard Deviations\n\n\n\n\n\n\n\n\n\n\n\nNontheistic Socialisation\n\n\nNormativity\n\n\n\nCountry\nMean\nSD\nMean\nSD\n\n\n\n\nBrazil\n1.889288\n1.348470\n5.395384\n1.251138\n\n\nChina\n3.896000\n1.534137\n4.445744\n1.437853\n\n\nDenmark\n2.616917\n1.502935\n2.636257\n1.627784\n\n\nJapan\n2.836689\n1.298559\n3.029182\n1.204015\n\n\nUK\n2.838355\n1.667143\n3.039862\n1.745857\n\n\nUSA\n2.357873\n1.575079\n4.012933\n1.523088\n\n\nGlobal\n2.751309\n1.614251\n3.753059\n1.758938\n\n\n\n\n\n\n\n\n\n\n\nNon-theistic SocialisationNormativityBelief in GodAnti-religiosityAge\n\n\n\n\nCode\ndat %&gt;%\n  ggplot(aes(x = nontheisticSocialisation, fill = country)) +\n  geom_density(alpha = 0.5) + \n  facet_wrap(~country) +        \n  labs(title = \"Density of Nontheistic Socialisation by Country\",\n       x = \"Nontheistic Socialisation\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(normativity), fill = country)) +\n  geom_density(alpha = 0.5) + \n  facet_wrap(~country) +        \n  labs(title = \"Density of Normativity by Country\",\n       x = \"Normativity\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(beliefInGod_ord), fill = country)) +\n  geom_histogram(alpha = 0.5, position = \"identity\", bins = 7) + \n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Belief in God by Country\",\n       x = \"Belief in God\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(antiReligiosity), fill = country)) +\n  geom_histogram(alpha = 0.5, position = \"identity\", bins = 7) + \n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Anti-religiosity by Country\",\n       x = \"Anti-religiosity\",\n       y = \"Density\") + \n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = age, fill = country)) +\n  geom_density(alpha = 0.5) + # Use geom_histogram instead of geom_density\n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Age by Country\",\n       x = \"Age\",\n       y = \"Count\") + # Change y-axis label to \"Count\" for histograms\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCountry Level EffectsGlobal Fixed Effects\n\n\n\n\n\n\n\n\n\n\n\n\n\nNOTE: the interaction effect seems like it is not different from zero. However, as we see in the country level plot it is in different directions in different countries which might cancel each other out.\n\n\nCode\nglobalPlot_nontheisticSocBiG &lt;- \n  posterior_params |&gt;\n  filter(country == \"Combined\") |&gt;\nggplot(aes(x = value, y = var)) +\n  stat_halfeye(\n    aes(fill = after_stat(level)),\n    .width = c(.89, .95, 1),\n    show_point = FALSE,\n    show_interval = FALSE\n  ) +\n  # 95% CI line only\n  stat_pointinterval(\n    .width = .95,\n    point_interval = \"median_qi\",\n    interval_size = .8,  # Adjust thickness of the 95% CI line\n    point_size = 1.5  # Adjust size of median point\n  ) +\n  scale_x_continuous(limits = c(-1, 2)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  scale_fill_brewer(palette = \"Blues\", direction = -1, na.translate = FALSE, labels = c(\"89%\", \"0.95%\", \"100%\")) +\n  theme_minimal() +\n  labs(\n    title = \"Parameter Values for Belief in God\",\n    subtitle = \"with median & intervals\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) +\nfacet_wrap(~country, ncol = 2, labeller = as_labeller(c(\n    \"Combined\" = \"Global Fixed Effects\",\n    \"USA\" = \"USA\",\n    \"UK\" = \"UK\",\n    \"Brazil\" = \"Brazil\",\n    \"Denmark\" = \"Denmark\",\n    \"Japan\" =  \"Japan\",\n    \"China\" =  \"China\"\n  ))) +\n  scale_y_discrete(labels = c(\n    \"age\" = \"Age\",\n    \"genderMale\" = \"Gender (Male)\",\n    \"nontheisticSocialisation\" = \"Nontheistic Socialization\",\n    \"normativity\" = \"Normativity\",\n    \"normativity:nontheisticSocialisation\" = \"Interaction\"\n  ))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese are the levels of belief in god that the model predicts for each level of nontheistic socialisation in each of the countries.\n\n\nPlot code\n# for some reason these plots ask for 4 colours.... we add black but it does nothing\n\nblue3 &lt;- c(pal_material(palette = \"blue\")(10)[c(2, 5, 8)], \"black\")\norange3 &lt;- c(pal_material(palette = \"orange\")(10)[c(2, 5, 8)], \"black\")\nred3 &lt;- c(pal_material(palette = \"red\")(10)[c(2, 5, 8)], \"black\")\ngreen3 &lt;- c(pal_material(palette = \"green\")(10)[c(2, 5, 8)], \"black\")\npurple3 &lt;- c(pal_material(palette = \"purple\")(10)[c(2, 5, 8)], \"black\")\nbrown3 &lt;- c(pal_material(palette = \"brown\")(10)[c(2, 5, 8)], \"black\")\n\nplot_list &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(predsCombinedOrig$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- predsCombinedOrig[predsCombinedOrig$country == country_name, ]\n  \n  #round normativity labels\n  \n  country_data$normativityOrig &lt;- factor(round(as.numeric(as.character(country_data$normativityOrig)), 2))\n\n  # Create a ggplot for each country\n  p &lt;- ggplot(country_data, aes(x = nontheisticSocialisationOrig, y = .epred)) +\n    # Ribbon fill with alpha\n    stat_lineribbon(aes(fill = factor(normativityOrig)), \n                    .width = 0.89, alpha = 0.3, color = NA, point_interval = \"median_qi\") +\n    # Ribbon line\n    stat_lineribbon(aes(color = factor(normativityOrig)), \n                    .width = 0.89, fill = NA, linewidth = 1, guide = \"none\")  +\n    \n    theme_minimal() +\n    theme(\n      legend.position = \"none\") +\n    labs(\n      title = country_name,  # Each plot gets a subheading with the country name\n      y = \"Belief in God\",\n      x = \"Nontheistic Socialisation\",\n      fill = \"Normativity\") +\n    \n    # Add custom colors for each country\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    \n    guides(fill = guide_legend(override.aes = list(alpha = 1)))\n  \n  # Append the plot to the list\n  plot_list[[country_name]] &lt;- p\n}\n\n\n# Combine the individual plots using patchwork and add the global title\n\nfinal_plot &lt;- wrap_plots(plot_list) +\n  plot_annotation(\n    title = \"Predicted values for Belief in God by Nontheistic Socialisation\",\n    subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n# Now create the legend-only plot\n\n\nlegend_plot &lt;- ggplot(data.frame(x = 1:3, y = 1:3, level = factor(1:3)), \n                      aes(x, y, fill = level)) +\n  geom_tile() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n        legend.margin = margin(0, 0, 0, 0),\n    legend.box.margin = margin(0, 0, 0, 0)\n  ) \n\n# Extract only the legend\nlegend_only &lt;- ggplotGrob(legend_plot)$grobs[[which(sapply(ggplotGrob(legend_plot)$grobs, function(x) x$name) == \"guide-box\")]]\n\ntable_grob_to_ggplot &lt;- function(table_grob) {\n  ggplot() +\n    annotation_custom(table_grob) +\n    theme_void()\n}\n\n# Convert your tableGrob to a ggplot object\nlegendPlot &lt;- table_grob_to_ggplot(legend_only)\n\n\npredsPlot_nontheisticSocBiG &lt;- final_plot / \n  plot_spacer() / \n  legend_only / \n  plot_spacer() +\n  plot_layout(\n    heights = c(20, 1, 1, 1)\n  ) +\n  plot_annotation(title = \"Predicted values for Belief in God by Nontheistic Socialisation\",\n                  subtitle = \"with median & 89% ETI\")\n\n\n\n# faceted plolegend_only# faceted plot:\n\n#  predsPlot_nontheisticSocBiG &lt;-\n#    ggplot(predsCombinedOrig, aes(x = nontheisticSocialisationOrig, y = .epred)) +\n#    # Ribbon fill with alpha\n#    stat_lineribbon(aes(fill = interaction(factor(normativityOrig), country)), .width = 0.89, alpha = 0.3, color = NA, #  point_interval = \"median_qi\") +\n#    # Ribbon line\n#    stat_lineribbon(aes(color = interaction(factor(normativityOrig), country)), .width = 0.89, fill = NA, linewidth = 1) +\n#  \n#    theme_minimal() +\n#    theme(\n#      legend.position = \"none\") +\n#    labs(\n#      title = \"Predicted values for Belief in God by Nontheistic Socialisation\",\n#      subtitle = \"with median & 89% ETI\",\n#      y = \"Belief in God\",\n#      x = \"Nontheistic Socialisation\") +\n#    facet_grid(~country)\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese plots show the predicted change in Belief in God (1-7) for a 1SD increase in Non-theistic Socialisation, broken down by Normativity:\n\n\nMarginal Effects Code\nglobalAME_nontheisticSocBiG &lt;- modNormativityNontheisticBiG %&gt;% \n  emtrends(~ normativity, \n           var = \"nontheisticSocialisation\", \n           at = list(normativity = c(-1,  0, 1), \n                     gender = c(\"Female\", \"Male\"),\n                     age = mean(datStd$age)),\n           epred = TRUE) %&gt;% \n  gather_emmeans_draws()\n\n# Convert back to original scale\nglobalAME_nontheisticSocBiG &lt;- globalAME_nontheisticSocBiG %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\ncountryAME_nontheisticSocBiG &lt;- modNormativityNontheisticBiG %&gt;%\n  emtrends(\n    ~ country + normativity,\n    var = \"nontheisticSocialisation\",\n    at = list(\n      normativity = c(-1,  0, 1),\n      gender = c(\"Female\", \"Male\"),\n      age = mean(datStd$age)\n    ),\n    epred = TRUE,\n    re_formula = NULL\n  ) %&gt;%\n  gather_emmeans_draws()\n\n# Convert back to original scale\ncountryAME_nontheisticSocBiG &lt;- countryAME_nontheisticSocBiG %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\n\nCountry Level EffectsGlobal Effects\n\n\n\n\nCode\nplot_list2 &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(countryAME_nontheisticSocBiG$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- countryAME_nontheisticSocBiG[countryAME_nontheisticSocBiG$country == country_name, ]\n  \n  p &lt;- ggplot(country_data, aes(x = .value, fill = factor(normativity))) +\n    stat_halfeye() +\n    scale_x_continuous(limits = c(-1.5, .5), breaks = seq(-1.5, .5, by = 0.25)) +\n    scale_y_continuous(limits = c(0, 1)) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n    theme_minimal() +\n    labs(\n      title = country_name,\n      y = NULL,\n      x = \"Average Marginal Effect\",\n      fill = \"Normativity\") +\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    theme(\n      legend.position = \"none\",\n      panel.grid.major.y = element_blank(),\n      panel.grid.minor.y = element_blank(),\n      axis.text.y = element_blank(),\n      axis.text.x = if (country_name == \"USA\") element_text() else element_blank(),\n      axis.title.x = if (country_name == \"USA\") element_text() else element_blank()\n    )\n  \n  # Append the plot to the list\n  plot_list2[[country_name]] &lt;- p\n}\n\n\n\nfinal_plot2 &lt;- wrap_plots(plot_list2, ncol = 1) +\n  plot_annotation(\n    title = \"Average Change in Belief in God\",\n    subtitle = \"Per 1SD increase in Non-theistic Socialisation\")\n\ncountryAMEPlot_nontheisticSocBiG &lt;- final_plot2 + legend_only\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalAMEPlot_nontheisticSocBiG &lt;- globalAME_nontheisticSocBiG  |&gt;\n  ggplot( aes(x=.value, fill = factor(normativity))) +\n   stat_halfeye() +\n  scale_x_continuous(limits = c(-1.5, 1.5), breaks = seq(-1.5, 1.5, by = 0.25)) +\n  scale_y_continuous(limits = c(0, 1)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  labs(\n    title = \"Predicted Change in Belief in God\",\n    subtitle = \"Per 1SD increase in Non-theistic Socialisation\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCountry Level EffectsGlobal Fixed Effects\n\n\n\n\n\n\n\n\n\n\n\n\n\nNOTE: the interaction effect seems like it is not different from zero. However, as we see in the country level plot it is in different directions in different countries which might cancel each other out.\n\n\nCode\nglobalPlot_nontheisticSocAR &lt;- \n  posterior_params |&gt;\n  filter(country == \"Combined\") |&gt;\nggplot(aes(x = value, y = var)) +\n  stat_halfeye(\n    aes(fill = after_stat(level)),\n    .width = c(.89, .95, 1),\n    show_point = FALSE,\n    show_interval = FALSE\n  ) +\n  # 95% CI line only\n  stat_pointinterval(\n    .width = .95,\n    point_interval = \"median_qi\",\n    interval_size = .8,  # Adjust thickness of the 95% CI line\n    point_size = 1.5  # Adjust size of median point\n  ) +\n  scale_x_continuous(limits = c(-1, 2)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  scale_fill_brewer(palette = \"Blues\", direction = -1, na.translate = FALSE, labels = c(\"89%\", \"0.95%\", \"100%\")) +\n  theme_minimal() +\n  labs(\n    title = \"Parameter Values for Anti-religiosity\",\n    subtitle = \"with median & intervals\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) +\nfacet_wrap(~country, ncol = 2, labeller = as_labeller(c(\n    \"Combined\" = \"Global Fixed Effects\",\n    \"USA\" = \"USA\",\n    \"UK\" = \"UK\",\n    \"Brazil\" = \"Brazil\",\n    \"Denmark\" = \"Denmark\",\n    \"Japan\" =  \"Japan\",\n    \"China\" =  \"China\"\n  ))) +\n  scale_y_discrete(labels = c(\n    \"age\" = \"Age\",\n    \"genderMale\" = \"Gender (Male)\",\n    \"nontheisticSocialisation\" = \"Nontheistic Socialization\",\n    \"normativity\" = \"Normativity\",\n    \"normativity:nontheisticSocialisation\" = \"Interaction\"\n  ))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese are the levels of anti-religiosity that the model predicts for each level of nontheistic socialisation in each of the countries.\n\n\nPlot code\n# for some reason these plots ask for 4 colours.... we add black but it does nothing\n\nblue3 &lt;- c(pal_material(palette = \"blue\")(10)[c(2, 5, 8)], \"black\")\norange3 &lt;- c(pal_material(palette = \"orange\")(10)[c(2, 5, 8)], \"black\")\nred3 &lt;- c(pal_material(palette = \"red\")(10)[c(2, 5, 8)], \"black\")\ngreen3 &lt;- c(pal_material(palette = \"green\")(10)[c(2, 5, 8)], \"black\")\npurple3 &lt;- c(pal_material(palette = \"purple\")(10)[c(2, 5, 8)], \"black\")\nbrown3 &lt;- c(pal_material(palette = \"brown\")(10)[c(2, 5, 8)], \"black\")\n\nplot_list &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(predsCombinedOrig$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- predsCombinedOrig[predsCombinedOrig$country == country_name, ]\n  \n  #round normativity labels\n  \n  country_data$normativityOrig &lt;- factor(round(as.numeric(as.character(country_data$normativityOrig)), 2))\n\n  # Create a ggplot for each country\n  p &lt;- ggplot(country_data, aes(x = nontheisticSocialisationOrig, y = .epred)) +\n    # Ribbon fill with alpha\n    stat_lineribbon(aes(fill = factor(normativityOrig)), \n                    .width = 0.89, alpha = 0.3, color = NA, point_interval = \"median_qi\") +\n    # Ribbon line\n    stat_lineribbon(aes(color = factor(normativityOrig)), \n                    .width = 0.89, fill = NA, linewidth = 1, guide = \"none\")  +\n    scale_y_continuous(limits = c(0, 7)) +\n\n    \n    theme_minimal() +\n    theme(\n      legend.position = \"none\") +\n    labs(\n      title = country_name,  # Each plot gets a subheading with the country name\n      y = \"Anti-religiosity\",\n      x = \"Nontheistic Socialisation\",\n      fill = \"Normativity\") +\n    \n    # Add custom colors for each country\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    \n    guides(fill = guide_legend(override.aes = list(alpha = 1)))\n  \n  # Append the plot to the list\n  plot_list[[country_name]] &lt;- p\n}\n\n\n# Combine the individual plots using patchwork and add the global title\n\nfinal_plot &lt;- wrap_plots(plot_list) +\n  plot_annotation(\n    title = \"Predicted values for Anti-religiosity by Nontheistic Socialisation\",\n    subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n# Now create the legend-only plot\n\n\nlegend_plot &lt;- ggplot(data.frame(x = 1:3, y = 1:3, level = factor(1:3)), \n                      aes(x, y, fill = level)) +\n  geom_tile() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n        legend.margin = margin(0, 0, 0, 0),\n    legend.box.margin = margin(0, 0, 0, 0)\n  ) \n\n# Extract only the legend\nlegend_only &lt;- ggplotGrob(legend_plot)$grobs[[which(sapply(ggplotGrob(legend_plot)$grobs, function(x) x$name) == \"guide-box\")]]\n\ntable_grob_to_ggplot &lt;- function(table_grob) {\n  ggplot() +\n    annotation_custom(table_grob) +\n    theme_void()\n}\n\n# Convert your tableGrob to a ggplot object\nlegendPlot &lt;- table_grob_to_ggplot(legend_only)\n\n\npredsPlot_nontheisticSocAR &lt;- final_plot / \n  plot_spacer() / \n  legend_only / \n  plot_spacer() +\n  plot_layout(\n    heights = c(20, 1, 1, 1)\n  ) +\n  plot_annotation(title = \"Predicted values for Anti-religiosity by Nontheistic Socialisation\",\n                  subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nMarginal Effects Code\nglobalAME_nontheisticSocAR &lt;- modNormativityNontheisticAR %&gt;% \n  emtrends(~ normativity, \n           var = \"nontheisticSocialisation\", \n           at = list(normativity = c(-1,  0, 1), \n                     gender = c(\"Female\", \"Male\"),\n                     age = mean(datStd$age)),\n           epred = TRUE) %&gt;% \n  gather_emmeans_draws()\n\n# Convert back to original scale\nglobalAME_nontheisticSocAR &lt;- globalAME_nontheisticSocAR %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\ncountryAME_nontheisticSocAR &lt;- modNormativityNontheisticAR %&gt;%\n  emtrends(\n    ~ country + normativity,\n    var = \"nontheisticSocialisation\",\n    at = list(\n      normativity = c(-1,  0, 1),\n      gender = c(\"Female\", \"Male\"),\n      age = mean(datStd$age)\n    ),\n    epred = TRUE,\n    re_formula = NULL\n  ) %&gt;%\n  gather_emmeans_draws()\n\n# Convert back to original scale\ncountryAME_nontheisticSocAR &lt;- countryAME_nontheisticSocAR %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\n\nCountry Level EffectsGlobal Effects\n\n\n\n\nCode\nplot_list2 &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(countryAME_nontheisticSocAR$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- countryAME_nontheisticSocAR[countryAME_nontheisticSocAR$country == country_name, ]\n  \n  p &lt;- ggplot(country_data, aes(x = .value, fill = factor(normativity))) +\n    stat_halfeye() + \n    scale_x_continuous(limits = c(-.5, 1.5), breaks = seq(-.5, 1.5, by = 0.25)) +\n    scale_y_continuous(limits = c(0, 1)) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n    theme_minimal() +\n    labs(\n      title = country_name,\n      y = NULL,\n      x = \"Average Marginal Effect\",\n      fill = \"Normativity\") +\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    theme(\n      legend.position = \"none\",\n      panel.grid.major.y = element_blank(),\n      panel.grid.minor.y = element_blank(),\n      axis.text.y = element_blank(),\n      axis.text.x = if (country_name == \"USA\") element_text() else element_blank(),\n      axis.title.x = if (country_name == \"USA\") element_text() else element_blank()\n    )\n  \n  # Append the plot to the list\n  plot_list2[[country_name]] &lt;- p\n}\n\n\n\nfinal_plot2 &lt;- wrap_plots(plot_list2, ncol = 1) +\n  plot_annotation(\n    title = \"Average Change in Anti-Religosity\",\n    subtitle = \"Per 1SD increase in Non-theistic Socialisation\")\n\ncountryAMEPlot_nontheisticSocAR &lt;- final_plot2 + legend_only\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalAMEPlot_nontheisticSocAR &lt;- globalAME_nontheisticSocAR  |&gt;\n  ggplot( aes(x=.value, fill = factor(normativity))) +\n   stat_halfeye() +\n  scale_x_continuous(limits = c(-1.5, 1.5), breaks = seq(-1.5, 1.5, by = 0.25)) +\n  scale_y_continuous(limits = c(0, 1)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  labs(\n    title = \"Average Change in Anti-Religosity\",\n    subtitle = \"Per 1SD increase in Non-theistic Socialisation\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGlobal EffectsCountry Effects",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Non-Theistic Socialisation"
    ]
  },
  {
    "objectID": "reports/antiReligion/nonTheisticSocialisation.html#predictor-variable-summaries",
    "href": "reports/antiReligion/nonTheisticSocialisation.html#predictor-variable-summaries",
    "title": "Non-Theistic Socialisation",
    "section": "",
    "text": "Global and Country-level Means and Standard Deviations\n\n\n\n\n\n\n\n\n\n\n\nNontheistic Socialisation\n\n\nNormativity\n\n\n\nCountry\nMean\nSD\nMean\nSD\n\n\n\n\nBrazil\n1.889288\n1.348470\n5.395384\n1.251138\n\n\nChina\n3.896000\n1.534137\n4.445744\n1.437853\n\n\nDenmark\n2.616917\n1.502935\n2.636257\n1.627784\n\n\nJapan\n2.836689\n1.298559\n3.029182\n1.204015\n\n\nUK\n2.838355\n1.667143\n3.039862\n1.745857\n\n\nUSA\n2.357873\n1.575079\n4.012933\n1.523088\n\n\nGlobal\n2.751309\n1.614251\n3.753059\n1.758938",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Non-Theistic Socialisation"
    ]
  },
  {
    "objectID": "reports/antiReligion/nonTheisticSocialisation.html#density-plots",
    "href": "reports/antiReligion/nonTheisticSocialisation.html#density-plots",
    "title": "Non-Theistic Socialisation",
    "section": "",
    "text": "Non-theistic SocialisationNormativityBelief in GodAnti-religiosityAge\n\n\n\n\nCode\ndat %&gt;%\n  ggplot(aes(x = nontheisticSocialisation, fill = country)) +\n  geom_density(alpha = 0.5) + \n  facet_wrap(~country) +        \n  labs(title = \"Density of Nontheistic Socialisation by Country\",\n       x = \"Nontheistic Socialisation\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(normativity), fill = country)) +\n  geom_density(alpha = 0.5) + \n  facet_wrap(~country) +        \n  labs(title = \"Density of Normativity by Country\",\n       x = \"Normativity\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(beliefInGod_ord), fill = country)) +\n  geom_histogram(alpha = 0.5, position = \"identity\", bins = 7) + \n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Belief in God by Country\",\n       x = \"Belief in God\",\n       y = \"Density\") +\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = as.numeric(antiReligiosity), fill = country)) +\n  geom_histogram(alpha = 0.5, position = \"identity\", bins = 7) + \n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Anti-religiosity by Country\",\n       x = \"Anti-religiosity\",\n       y = \"Density\") + \n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat |&gt;\n  ggplot(aes(x = age, fill = country)) +\n  geom_density(alpha = 0.5) + # Use geom_histogram instead of geom_density\n  facet_wrap(~country) +        \n  labs(title = \"Histogram of Age by Country\",\n       x = \"Age\",\n       y = \"Count\") + # Change y-axis label to \"Count\" for histograms\n  scale_fill_manual(values = c(\n    \"Brazil\" = green1,\n    \"China\" = purple1,\n    \"Denmark\" = brown1,\n    \"Japan\" = red1,\n    \"UK\" = blue1,\n    \"USA\" = orange1\n  )) +\n  theme_minimal()",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Non-Theistic Socialisation"
    ]
  },
  {
    "objectID": "reports/antiReligion/nonTheisticSocialisation.html#belief-in-god-models",
    "href": "reports/antiReligion/nonTheisticSocialisation.html#belief-in-god-models",
    "title": "Non-Theistic Socialisation",
    "section": "",
    "text": "Country Level EffectsGlobal Fixed Effects\n\n\n\n\n\n\n\n\n\n\n\n\n\nNOTE: the interaction effect seems like it is not different from zero. However, as we see in the country level plot it is in different directions in different countries which might cancel each other out.\n\n\nCode\nglobalPlot_nontheisticSocBiG &lt;- \n  posterior_params |&gt;\n  filter(country == \"Combined\") |&gt;\nggplot(aes(x = value, y = var)) +\n  stat_halfeye(\n    aes(fill = after_stat(level)),\n    .width = c(.89, .95, 1),\n    show_point = FALSE,\n    show_interval = FALSE\n  ) +\n  # 95% CI line only\n  stat_pointinterval(\n    .width = .95,\n    point_interval = \"median_qi\",\n    interval_size = .8,  # Adjust thickness of the 95% CI line\n    point_size = 1.5  # Adjust size of median point\n  ) +\n  scale_x_continuous(limits = c(-1, 2)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  scale_fill_brewer(palette = \"Blues\", direction = -1, na.translate = FALSE, labels = c(\"89%\", \"0.95%\", \"100%\")) +\n  theme_minimal() +\n  labs(\n    title = \"Parameter Values for Belief in God\",\n    subtitle = \"with median & intervals\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) +\nfacet_wrap(~country, ncol = 2, labeller = as_labeller(c(\n    \"Combined\" = \"Global Fixed Effects\",\n    \"USA\" = \"USA\",\n    \"UK\" = \"UK\",\n    \"Brazil\" = \"Brazil\",\n    \"Denmark\" = \"Denmark\",\n    \"Japan\" =  \"Japan\",\n    \"China\" =  \"China\"\n  ))) +\n  scale_y_discrete(labels = c(\n    \"age\" = \"Age\",\n    \"genderMale\" = \"Gender (Male)\",\n    \"nontheisticSocialisation\" = \"Nontheistic Socialization\",\n    \"normativity\" = \"Normativity\",\n    \"normativity:nontheisticSocialisation\" = \"Interaction\"\n  ))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese are the levels of belief in god that the model predicts for each level of nontheistic socialisation in each of the countries.\n\n\nPlot code\n# for some reason these plots ask for 4 colours.... we add black but it does nothing\n\nblue3 &lt;- c(pal_material(palette = \"blue\")(10)[c(2, 5, 8)], \"black\")\norange3 &lt;- c(pal_material(palette = \"orange\")(10)[c(2, 5, 8)], \"black\")\nred3 &lt;- c(pal_material(palette = \"red\")(10)[c(2, 5, 8)], \"black\")\ngreen3 &lt;- c(pal_material(palette = \"green\")(10)[c(2, 5, 8)], \"black\")\npurple3 &lt;- c(pal_material(palette = \"purple\")(10)[c(2, 5, 8)], \"black\")\nbrown3 &lt;- c(pal_material(palette = \"brown\")(10)[c(2, 5, 8)], \"black\")\n\nplot_list &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(predsCombinedOrig$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- predsCombinedOrig[predsCombinedOrig$country == country_name, ]\n  \n  #round normativity labels\n  \n  country_data$normativityOrig &lt;- factor(round(as.numeric(as.character(country_data$normativityOrig)), 2))\n\n  # Create a ggplot for each country\n  p &lt;- ggplot(country_data, aes(x = nontheisticSocialisationOrig, y = .epred)) +\n    # Ribbon fill with alpha\n    stat_lineribbon(aes(fill = factor(normativityOrig)), \n                    .width = 0.89, alpha = 0.3, color = NA, point_interval = \"median_qi\") +\n    # Ribbon line\n    stat_lineribbon(aes(color = factor(normativityOrig)), \n                    .width = 0.89, fill = NA, linewidth = 1, guide = \"none\")  +\n    \n    theme_minimal() +\n    theme(\n      legend.position = \"none\") +\n    labs(\n      title = country_name,  # Each plot gets a subheading with the country name\n      y = \"Belief in God\",\n      x = \"Nontheistic Socialisation\",\n      fill = \"Normativity\") +\n    \n    # Add custom colors for each country\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    \n    guides(fill = guide_legend(override.aes = list(alpha = 1)))\n  \n  # Append the plot to the list\n  plot_list[[country_name]] &lt;- p\n}\n\n\n# Combine the individual plots using patchwork and add the global title\n\nfinal_plot &lt;- wrap_plots(plot_list) +\n  plot_annotation(\n    title = \"Predicted values for Belief in God by Nontheistic Socialisation\",\n    subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n# Now create the legend-only plot\n\n\nlegend_plot &lt;- ggplot(data.frame(x = 1:3, y = 1:3, level = factor(1:3)), \n                      aes(x, y, fill = level)) +\n  geom_tile() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n        legend.margin = margin(0, 0, 0, 0),\n    legend.box.margin = margin(0, 0, 0, 0)\n  ) \n\n# Extract only the legend\nlegend_only &lt;- ggplotGrob(legend_plot)$grobs[[which(sapply(ggplotGrob(legend_plot)$grobs, function(x) x$name) == \"guide-box\")]]\n\ntable_grob_to_ggplot &lt;- function(table_grob) {\n  ggplot() +\n    annotation_custom(table_grob) +\n    theme_void()\n}\n\n# Convert your tableGrob to a ggplot object\nlegendPlot &lt;- table_grob_to_ggplot(legend_only)\n\n\npredsPlot_nontheisticSocBiG &lt;- final_plot / \n  plot_spacer() / \n  legend_only / \n  plot_spacer() +\n  plot_layout(\n    heights = c(20, 1, 1, 1)\n  ) +\n  plot_annotation(title = \"Predicted values for Belief in God by Nontheistic Socialisation\",\n                  subtitle = \"with median & 89% ETI\")\n\n\n\n# faceted plolegend_only# faceted plot:\n\n#  predsPlot_nontheisticSocBiG &lt;-\n#    ggplot(predsCombinedOrig, aes(x = nontheisticSocialisationOrig, y = .epred)) +\n#    # Ribbon fill with alpha\n#    stat_lineribbon(aes(fill = interaction(factor(normativityOrig), country)), .width = 0.89, alpha = 0.3, color = NA, #  point_interval = \"median_qi\") +\n#    # Ribbon line\n#    stat_lineribbon(aes(color = interaction(factor(normativityOrig), country)), .width = 0.89, fill = NA, linewidth = 1) +\n#  \n#    theme_minimal() +\n#    theme(\n#      legend.position = \"none\") +\n#    labs(\n#      title = \"Predicted values for Belief in God by Nontheistic Socialisation\",\n#      subtitle = \"with median & 89% ETI\",\n#      y = \"Belief in God\",\n#      x = \"Nontheistic Socialisation\") +\n#    facet_grid(~country)\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese plots show the predicted change in Belief in God (1-7) for a 1SD increase in Non-theistic Socialisation, broken down by Normativity:\n\n\nMarginal Effects Code\nglobalAME_nontheisticSocBiG &lt;- modNormativityNontheisticBiG %&gt;% \n  emtrends(~ normativity, \n           var = \"nontheisticSocialisation\", \n           at = list(normativity = c(-1,  0, 1), \n                     gender = c(\"Female\", \"Male\"),\n                     age = mean(datStd$age)),\n           epred = TRUE) %&gt;% \n  gather_emmeans_draws()\n\n# Convert back to original scale\nglobalAME_nontheisticSocBiG &lt;- globalAME_nontheisticSocBiG %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\ncountryAME_nontheisticSocBiG &lt;- modNormativityNontheisticBiG %&gt;%\n  emtrends(\n    ~ country + normativity,\n    var = \"nontheisticSocialisation\",\n    at = list(\n      normativity = c(-1,  0, 1),\n      gender = c(\"Female\", \"Male\"),\n      age = mean(datStd$age)\n    ),\n    epred = TRUE,\n    re_formula = NULL\n  ) %&gt;%\n  gather_emmeans_draws()\n\n# Convert back to original scale\ncountryAME_nontheisticSocBiG &lt;- countryAME_nontheisticSocBiG %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\n\nCountry Level EffectsGlobal Effects\n\n\n\n\nCode\nplot_list2 &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(countryAME_nontheisticSocBiG$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- countryAME_nontheisticSocBiG[countryAME_nontheisticSocBiG$country == country_name, ]\n  \n  p &lt;- ggplot(country_data, aes(x = .value, fill = factor(normativity))) +\n    stat_halfeye() +\n    scale_x_continuous(limits = c(-1.5, .5), breaks = seq(-1.5, .5, by = 0.25)) +\n    scale_y_continuous(limits = c(0, 1)) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n    theme_minimal() +\n    labs(\n      title = country_name,\n      y = NULL,\n      x = \"Average Marginal Effect\",\n      fill = \"Normativity\") +\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    theme(\n      legend.position = \"none\",\n      panel.grid.major.y = element_blank(),\n      panel.grid.minor.y = element_blank(),\n      axis.text.y = element_blank(),\n      axis.text.x = if (country_name == \"USA\") element_text() else element_blank(),\n      axis.title.x = if (country_name == \"USA\") element_text() else element_blank()\n    )\n  \n  # Append the plot to the list\n  plot_list2[[country_name]] &lt;- p\n}\n\n\n\nfinal_plot2 &lt;- wrap_plots(plot_list2, ncol = 1) +\n  plot_annotation(\n    title = \"Average Change in Belief in God\",\n    subtitle = \"Per 1SD increase in Non-theistic Socialisation\")\n\ncountryAMEPlot_nontheisticSocBiG &lt;- final_plot2 + legend_only\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalAMEPlot_nontheisticSocBiG &lt;- globalAME_nontheisticSocBiG  |&gt;\n  ggplot( aes(x=.value, fill = factor(normativity))) +\n   stat_halfeye() +\n  scale_x_continuous(limits = c(-1.5, 1.5), breaks = seq(-1.5, 1.5, by = 0.25)) +\n  scale_y_continuous(limits = c(0, 1)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  labs(\n    title = \"Predicted Change in Belief in God\",\n    subtitle = \"Per 1SD increase in Non-theistic Socialisation\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  )",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Non-Theistic Socialisation"
    ]
  },
  {
    "objectID": "reports/antiReligion/nonTheisticSocialisation.html#anti-religiosity-models",
    "href": "reports/antiReligion/nonTheisticSocialisation.html#anti-religiosity-models",
    "title": "Non-Theistic Socialisation",
    "section": "",
    "text": "Country Level EffectsGlobal Fixed Effects\n\n\n\n\n\n\n\n\n\n\n\n\n\nNOTE: the interaction effect seems like it is not different from zero. However, as we see in the country level plot it is in different directions in different countries which might cancel each other out.\n\n\nCode\nglobalPlot_nontheisticSocAR &lt;- \n  posterior_params |&gt;\n  filter(country == \"Combined\") |&gt;\nggplot(aes(x = value, y = var)) +\n  stat_halfeye(\n    aes(fill = after_stat(level)),\n    .width = c(.89, .95, 1),\n    show_point = FALSE,\n    show_interval = FALSE\n  ) +\n  # 95% CI line only\n  stat_pointinterval(\n    .width = .95,\n    point_interval = \"median_qi\",\n    interval_size = .8,  # Adjust thickness of the 95% CI line\n    point_size = 1.5  # Adjust size of median point\n  ) +\n  scale_x_continuous(limits = c(-1, 2)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  scale_fill_brewer(palette = \"Blues\", direction = -1, na.translate = FALSE, labels = c(\"89%\", \"0.95%\", \"100%\")) +\n  theme_minimal() +\n  labs(\n    title = \"Parameter Values for Anti-religiosity\",\n    subtitle = \"with median & intervals\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  ) +\nfacet_wrap(~country, ncol = 2, labeller = as_labeller(c(\n    \"Combined\" = \"Global Fixed Effects\",\n    \"USA\" = \"USA\",\n    \"UK\" = \"UK\",\n    \"Brazil\" = \"Brazil\",\n    \"Denmark\" = \"Denmark\",\n    \"Japan\" =  \"Japan\",\n    \"China\" =  \"China\"\n  ))) +\n  scale_y_discrete(labels = c(\n    \"age\" = \"Age\",\n    \"genderMale\" = \"Gender (Male)\",\n    \"nontheisticSocialisation\" = \"Nontheistic Socialization\",\n    \"normativity\" = \"Normativity\",\n    \"normativity:nontheisticSocialisation\" = \"Interaction\"\n  ))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese are the levels of anti-religiosity that the model predicts for each level of nontheistic socialisation in each of the countries.\n\n\nPlot code\n# for some reason these plots ask for 4 colours.... we add black but it does nothing\n\nblue3 &lt;- c(pal_material(palette = \"blue\")(10)[c(2, 5, 8)], \"black\")\norange3 &lt;- c(pal_material(palette = \"orange\")(10)[c(2, 5, 8)], \"black\")\nred3 &lt;- c(pal_material(palette = \"red\")(10)[c(2, 5, 8)], \"black\")\ngreen3 &lt;- c(pal_material(palette = \"green\")(10)[c(2, 5, 8)], \"black\")\npurple3 &lt;- c(pal_material(palette = \"purple\")(10)[c(2, 5, 8)], \"black\")\nbrown3 &lt;- c(pal_material(palette = \"brown\")(10)[c(2, 5, 8)], \"black\")\n\nplot_list &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(predsCombinedOrig$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- predsCombinedOrig[predsCombinedOrig$country == country_name, ]\n  \n  #round normativity labels\n  \n  country_data$normativityOrig &lt;- factor(round(as.numeric(as.character(country_data$normativityOrig)), 2))\n\n  # Create a ggplot for each country\n  p &lt;- ggplot(country_data, aes(x = nontheisticSocialisationOrig, y = .epred)) +\n    # Ribbon fill with alpha\n    stat_lineribbon(aes(fill = factor(normativityOrig)), \n                    .width = 0.89, alpha = 0.3, color = NA, point_interval = \"median_qi\") +\n    # Ribbon line\n    stat_lineribbon(aes(color = factor(normativityOrig)), \n                    .width = 0.89, fill = NA, linewidth = 1, guide = \"none\")  +\n    scale_y_continuous(limits = c(0, 7)) +\n\n    \n    theme_minimal() +\n    theme(\n      legend.position = \"none\") +\n    labs(\n      title = country_name,  # Each plot gets a subheading with the country name\n      y = \"Anti-religiosity\",\n      x = \"Nontheistic Socialisation\",\n      fill = \"Normativity\") +\n    \n    # Add custom colors for each country\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    \n    guides(fill = guide_legend(override.aes = list(alpha = 1)))\n  \n  # Append the plot to the list\n  plot_list[[country_name]] &lt;- p\n}\n\n\n# Combine the individual plots using patchwork and add the global title\n\nfinal_plot &lt;- wrap_plots(plot_list) +\n  plot_annotation(\n    title = \"Predicted values for Anti-religiosity by Nontheistic Socialisation\",\n    subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n# Now create the legend-only plot\n\n\nlegend_plot &lt;- ggplot(data.frame(x = 1:3, y = 1:3, level = factor(1:3)), \n                      aes(x, y, fill = level)) +\n  geom_tile() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n        legend.margin = margin(0, 0, 0, 0),\n    legend.box.margin = margin(0, 0, 0, 0)\n  ) \n\n# Extract only the legend\nlegend_only &lt;- ggplotGrob(legend_plot)$grobs[[which(sapply(ggplotGrob(legend_plot)$grobs, function(x) x$name) == \"guide-box\")]]\n\ntable_grob_to_ggplot &lt;- function(table_grob) {\n  ggplot() +\n    annotation_custom(table_grob) +\n    theme_void()\n}\n\n# Convert your tableGrob to a ggplot object\nlegendPlot &lt;- table_grob_to_ggplot(legend_only)\n\n\npredsPlot_nontheisticSocAR &lt;- final_plot / \n  plot_spacer() / \n  legend_only / \n  plot_spacer() +\n  plot_layout(\n    heights = c(20, 1, 1, 1)\n  ) +\n  plot_annotation(title = \"Predicted values for Anti-religiosity by Nontheistic Socialisation\",\n                  subtitle = \"with median & 89% ETI\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nMarginal Effects Code\nglobalAME_nontheisticSocAR &lt;- modNormativityNontheisticAR %&gt;% \n  emtrends(~ normativity, \n           var = \"nontheisticSocialisation\", \n           at = list(normativity = c(-1,  0, 1), \n                     gender = c(\"Female\", \"Male\"),\n                     age = mean(datStd$age)),\n           epred = TRUE) %&gt;% \n  gather_emmeans_draws()\n\n# Convert back to original scale\nglobalAME_nontheisticSocAR &lt;- globalAME_nontheisticSocAR %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\ncountryAME_nontheisticSocAR &lt;- modNormativityNontheisticAR %&gt;%\n  emtrends(\n    ~ country + normativity,\n    var = \"nontheisticSocialisation\",\n    at = list(\n      normativity = c(-1,  0, 1),\n      gender = c(\"Female\", \"Male\"),\n      age = mean(datStd$age)\n    ),\n    epred = TRUE,\n    re_formula = NULL\n  ) %&gt;%\n  gather_emmeans_draws()\n\n# Convert back to original scale\ncountryAME_nontheisticSocAR &lt;- countryAME_nontheisticSocAR %&gt;%\n  mutate(normativity_orig = (normativity * sd(dat2$normativity)) + mean(dat2$normativity))\n\n\n\nCountry Level EffectsGlobal Effects\n\n\n\n\nCode\nplot_list2 &lt;- list()\n\ncountry_colors &lt;- list(\n    \"Brazil\" = green3,\n    \"China\" = purple3,\n    \"Denmark\" = brown3,\n    \"Japan\" = red3,\n    \"UK\" = blue3,\n    \"USA\" = orange3)\n\ncountries &lt;- unique(countryAME_nontheisticSocAR$country)\n\nfor (country_name in countries) {\n  # Filter data for each country\n  \n  country_data &lt;- countryAME_nontheisticSocAR[countryAME_nontheisticSocAR$country == country_name, ]\n  \n  p &lt;- ggplot(country_data, aes(x = .value, fill = factor(normativity))) +\n    stat_halfeye() + \n    scale_x_continuous(limits = c(-.5, 1.5), breaks = seq(-.5, 1.5, by = 0.25)) +\n    scale_y_continuous(limits = c(0, 1)) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n    theme_minimal() +\n    labs(\n      title = country_name,\n      y = NULL,\n      x = \"Average Marginal Effect\",\n      fill = \"Normativity\") +\n    scale_fill_manual(values = country_colors[[country_name]]) +\n    scale_color_manual(values = country_colors[[country_name]], guide = \"none\") +\n    theme(\n      legend.position = \"none\",\n      panel.grid.major.y = element_blank(),\n      panel.grid.minor.y = element_blank(),\n      axis.text.y = element_blank(),\n      axis.text.x = if (country_name == \"USA\") element_text() else element_blank(),\n      axis.title.x = if (country_name == \"USA\") element_text() else element_blank()\n    )\n  \n  # Append the plot to the list\n  plot_list2[[country_name]] &lt;- p\n}\n\n\n\nfinal_plot2 &lt;- wrap_plots(plot_list2, ncol = 1) +\n  plot_annotation(\n    title = \"Average Change in Anti-Religosity\",\n    subtitle = \"Per 1SD increase in Non-theistic Socialisation\")\n\ncountryAMEPlot_nontheisticSocAR &lt;- final_plot2 + legend_only\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nglobalAMEPlot_nontheisticSocAR &lt;- globalAME_nontheisticSocAR  |&gt;\n  ggplot( aes(x=.value, fill = factor(normativity))) +\n   stat_halfeye() +\n  scale_x_continuous(limits = c(-1.5, 1.5), breaks = seq(-1.5, 1.5, by = 0.25)) +\n  scale_y_continuous(limits = c(0, 1)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"grey80\", \"grey50\", \"grey20\"),\n    labels = c(\"Low\", \"Mean\", \"High\"),\n    name = \"Normativity\"\n  ) +\n  labs(\n    title = \"Average Change in Anti-Religosity\",\n    subtitle = \"Per 1SD increase in Non-theistic Socialisation\",\n    x = NULL,\n    y = NULL,\n    fill = \"Interval\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_blank()\n  )",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Non-Theistic Socialisation"
    ]
  },
  {
    "objectID": "reports/antiReligion/nonTheisticSocialisation.html#belief-in-god-anti-religiosity-comparison",
    "href": "reports/antiReligion/nonTheisticSocialisation.html#belief-in-god-anti-religiosity-comparison",
    "title": "Non-Theistic Socialisation",
    "section": "",
    "text": "Global EffectsCountry Effects",
    "crumbs": [
      "Reports",
      "Anti-religiosity",
      "Non-Theistic Socialisation"
    ]
  }
]